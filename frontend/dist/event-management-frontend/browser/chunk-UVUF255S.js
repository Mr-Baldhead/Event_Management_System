import{a as D}from"./chunk-JWYXLJQ3.js";import{c as $}from"./chunk-ZKWHU6RX.js";import{A as V,B as z,b as R,c as T,d as A,e as I,f as F}from"./chunk-PZ4Z3RAM.js";import{g as w,j as k,n as E,q as S}from"./chunk-EGCVCM76.js";import{Aa as g,Ab as C,Bb as f,Cb as u,Db as o,Eb as n,Fb as M,Jb as O,Lb as x,Mb as c,Xb as i,Yb as h,Za as p,_b as y,ba as d,fc as v,ja as m,jb as P,ka as s,ob as _,ub as b}from"./chunk-QXQWZ6TV.js";var L=t=>["/events",t],N=(t,a)=>a.allergyName,B=(t,a)=>a.participantId;function j(t,a){t&1&&M(0,"app-loading-spinner",2)}function H(t,a){t&1&&(o(0,"div",8)(1,"mat-icon"),i(2,"check_circle"),n(),o(3,"h3"),i(4,"Inga allergier registrerade"),n(),o(5,"p"),i(6,"Det finns inga deltagare med allergier f\xF6r detta event."),n()())}function K(t,a){if(t&1&&(o(0,"div",12)(1,"span",13),i(2),n(),o(3,"span",14),i(4),n()()),t&2){let e=a.$implicit;p(2),h(e.fullName),p(2),h(e.patrol||"")}}function q(t,a){if(t&1&&(o(0,"div",9)(1,"div",10),i(2),n(),o(3,"div",11),f(4,K,5,2,"div",12,B),n()()),t&2){let e=a.$implicit;p(2),y(" ",e.allergyName," ",e.count," st. "),p(2),u(e.participants)}}function G(t,a){if(t&1&&f(0,q,6,2,"div",9,N),t&2){let e=c(2);u(e.report().allergies)}}function J(t,a){if(t&1){let e=O();o(0,"div",3)(1,"div",5)(2,"button",6),x("click",function(){m(e);let l=c();return s(l.exportExcel())}),i(3," Exportera till Excel "),n(),o(4,"button",7),x("click",function(){m(e);let l=c();return s(l.exportPDF())}),i(5," Exportera till PDF "),n(),o(6,"button",6),x("click",function(){m(e);let l=c();return s(l.exportCSV())}),i(7," Exportera till CSV "),n()(),_(8,H,7,0,"div",8)(9,G,2,0),n()}if(t&2){let e=c();p(8),C(e.report().allergies.length===0?8:9)}}function Q(t,a){t&1&&(o(0,"div",4)(1,"mat-icon"),i(2,"error"),n(),o(3,"h3"),i(4,"Kunde inte ladda rapporten"),n(),o(5,"p"),i(6,"N\xE5got gick fel n\xE4r rapporten skulle h\xE4mtas."),n(),o(7,"a",15),i(8," Tillbaka till events "),n()())}var pt=(()=>{class t{route=d(E);http=d(k);snackBar=d(V);loading=g(!0);eventId=g(0);report=g(null);ngOnInit(){let e=this.route.snapshot.paramMap.get("id");if(e){let r=parseInt(e,10);isNaN(r)?this.loading.set(!1):(this.eventId.set(r),this.loadReport(r))}else this.loading.set(!1)}loadReport(e){this.loading.set(!0),this.http.get(`/api/events/${e}/allergy-report`).subscribe({next:r=>{this.report.set(r),this.loading.set(!1)},error:r=>{console.error("Failed to load allergy report:",r),this.report.set(null),this.loading.set(!1)}})}exportExcel(){let e=this.eventId();window.location.href=`/api/events/${e}/allergy-report/excel`}exportPDF(){window.print()}exportCSV(){let e=this.eventId();window.location.href=`/api/events/${e}/allergy-report/csv`}static \u0275fac=function(r){return new(r||t)};static \u0275cmp=P({type:t,selectors:[["app-allergy-report"]],decls:9,vars:4,consts:[[1,"container"],[1,"back-link",3,"routerLink"],["message","Laddar allergirapport..."],[1,"report-content"],[1,"error-state"],[1,"export-buttons"],["mat-stroked-button","",3,"click"],["mat-flat-button","","color","primary",3,"click"],[1,"empty-state"],[1,"allergy-group"],[1,"allergy-header"],[1,"participants-list"],[1,"participant-row"],[1,"name"],[1,"patrol"],["mat-flat-button","","color","primary","routerLink","/events"]],template:function(r,l){r&1&&(M(0,"app-header"),o(1,"main",0)(2,"a",1)(3,"mat-icon"),i(4,"arrow_back"),n(),i(5," Tillbaka till event "),n(),_(6,j,1,0,"app-loading-spinner",2)(7,J,10,1,"div",3)(8,Q,9,0,"div",4),n()),r&2&&(p(2),b("routerLink",v(2,L,l.eventId())),p(4),C(l.loading()?6:l.report()?7:8))},dependencies:[w,S,A,T,R,F,I,z,$,D],styles:["main[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:32px 24px}.back-link[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;color:#1d968c;text-decoration:none;font-weight:500;margin-bottom:24px}.back-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.report-content[_ngcontent-%COMP%]{background:#fff;padding:32px;border-radius:12px;box-shadow:0 2px 8px #0000001a}.export-buttons[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:12px;margin-bottom:40px}.export-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-weight:500}.allergy-group[_ngcontent-%COMP%]{margin-bottom:40px}.allergy-header[_ngcontent-%COMP%]{background:#416487;color:#fff;padding:14px 24px;font-size:20px;font-weight:600;font-style:italic}.participants-list[_ngcontent-%COMP%]{padding:8px 0}.participant-row[_ngcontent-%COMP%]{display:flex;padding:10px 24px;border-bottom:1px solid #F0F0F0;font-size:16px}.participant-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.participant-row[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{min-width:220px;color:#1f2023}.participant-row[_ngcontent-%COMP%]   .patrol[_ngcontent-%COMP%]{color:#5f6166}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:64px 32px;color:#82848c}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:72px;width:72px;height:72px;color:#4caf50;margin-bottom:24px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#5f6166;margin-bottom:8px;font-size:20px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#82848c}.error-state[_ngcontent-%COMP%]{text-align:center;padding:64px 32px;background:#fff;border-radius:12px;box-shadow:0 2px 8px #0000001a}.error-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:72px;width:72px;height:72px;color:#dc3545;margin-bottom:24px}.error-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#5f6166;margin-bottom:8px}.error-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#82848c;margin-bottom:24px}@media (max-width: 576px){.report-content[_ngcontent-%COMP%]{padding:20px}.export-buttons[_ngcontent-%COMP%]{flex-direction:column}.export-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}.participant-row[_ngcontent-%COMP%]{flex-direction:column;gap:4px;padding:12px 16px}.participant-row[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{min-width:auto;font-weight:500}.participant-row[_ngcontent-%COMP%]   .patrol[_ngcontent-%COMP%]{font-size:14px}.allergy-header[_ngcontent-%COMP%]{padding:12px 16px;font-size:18px}}@media print{.export-buttons[_ngcontent-%COMP%], .back-link[_ngcontent-%COMP%], app-header[_ngcontent-%COMP%]{display:none!important}.report-content[_ngcontent-%COMP%]{box-shadow:none;padding:0}.allergy-header[_ngcontent-%COMP%]{background:#416487!important;color:#fff!important;-webkit-print-color-adjust:exact;print-color-adjust:exact}}"]})}return t})();export{pt as AllergyReportComponent};
