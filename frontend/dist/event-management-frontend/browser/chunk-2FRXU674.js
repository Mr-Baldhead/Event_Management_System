import{j as u}from"./chunk-EGCVCM76.js";import{Aa as a,B as i,U as r,X as d,aa as v,o as p,pc as h}from"./chunk-QXQWZ6TV.js";var m=(()=>{class n{http;apiUrl="/api/events";_events=a([]);_selectedEvent=a(null);_loading=a(!1);_error=a(null);events=this._events.asReadonly();selectedEvent=this._selectedEvent.asReadonly();loading=this._loading.asReadonly();error=this._error.asReadonly();activeEvents=h(()=>this._events().filter(t=>t.active));eventCount=h(()=>this._events().length);hasEvents=h(()=>this._events().length>0);constructor(t){this.http=t}loadEvents(){this._loading.set(!0),this._error.set(null),this.http.get(this.apiUrl).pipe(r(t=>{this._events.set(t),this._loading.set(!1)}),i(t=>this.handleError(t))).subscribe()}getEvents(){return this.http.get(this.apiUrl)}loadEvent(t){this._loading.set(!0),this._error.set(null),this.http.get(`${this.apiUrl}/${t}`).pipe(r(e=>{this._selectedEvent.set(e),this._loading.set(!1)}),i(e=>this.handleError(e))).subscribe()}getEvent(t){return this.http.get(`${this.apiUrl}/${t}`)}getEventBySlug(t){return this.http.get(`${this.apiUrl}/slug/${t}`)}createEvent(t){return this._loading.set(!0),this._error.set(null),this.http.post(this.apiUrl,t).pipe(r(e=>{this._events.update(s=>[...s,e]),this._loading.set(!1)}),i(e=>this.handleError(e)))}updateEvent(t,e){return this._loading.set(!0),this._error.set(null),this.http.put(`${this.apiUrl}/${t}`,e).pipe(r(s=>{this._events.update(o=>o.map(l=>l.id===t?s:l)),this._selectedEvent.set(s),this._loading.set(!1)}),i(s=>this.handleError(s)))}patchEvent(t,e){return this.http.patch(`${this.apiUrl}/${t}`,e).pipe(r(s=>{this._events.update(o=>o.map(l=>l.id===t?s:l)),this._selectedEvent()?.id===t&&this._selectedEvent.set(s)}),i(s=>this.handleError(s)))}deleteEvent(t){return this._loading.set(!0),this._error.set(null),this.http.delete(`${this.apiUrl}/${t}`).pipe(r(()=>{this._events.update(e=>e.filter(s=>s.id!==t)),this._selectedEvent()?.id===t&&this._selectedEvent.set(null),this._loading.set(!1)}),i(e=>this.handleError(e)))}clearSelectedEvent(){this._selectedEvent.set(null)}clearError(){this._error.set(null)}handleError(t){let e="Ett ov\xE4ntat fel intr\xE4ffade";return t.error instanceof ErrorEvent?e=t.error.message:t.status===404?e="Event hittades inte":t.status===400?e=t.error?.message||"Ogiltig f\xF6rfr\xE5gan":t.status===500&&(e="Serverfel - f\xF6rs\xF6k igen senare"),this._error.set(e),this._loading.set(!1),p(()=>new Error(e))}static \u0275fac=function(e){return new(e||n)(v(u))};static \u0275prov=d({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();export{m as a};
