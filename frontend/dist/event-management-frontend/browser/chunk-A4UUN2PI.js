import{j as g}from"./chunk-EGCVCM76.js";import{Aa as u,B as o,U as h,X as c,ba as f,o as n}from"./chunk-QXQWZ6TV.js";var $=(()=>{class l{apiUrl="/api/users";http=f(g);_users=u([]);_loading=u(!1);_error=u(null);users=this._users.asReadonly();loading=this._loading.asReadonly();error=this._error.asReadonly();getAdmins(){return this._loading.set(!0),this._error.set(null),this.http.get(this.apiUrl,{withCredentials:!0}).pipe(h(e=>{this._users.set(e),this._loading.set(!1)}),o(e=>(this._error.set("Kunde inte h\xE4mta anv\xE4ndare"),this._loading.set(!1),n(()=>e))))}getCounts(){return this.http.get(`${this.apiUrl}/counts`,{withCredentials:!0})}createAdmin(e){return this.http.post(this.apiUrl,e,{withCredentials:!0}).pipe(h(t=>{this._users.update(r=>[...r,t])}),o(t=>(this._error.set(t.error?.error||"Kunde inte skapa anv\xE4ndare"),n(()=>t))))}updateUser(e,t){return this.http.put(`${this.apiUrl}/${e}`,t,{withCredentials:!0}).pipe(h(r=>{this._users.update(i=>i.map(s=>s.id===e?r:s))}),o(r=>(this._error.set(r.error?.error||"Kunde inte uppdatera anv\xE4ndare"),n(()=>r))))}deleteUser(e){return this.http.delete(`${this.apiUrl}/${e}`,{withCredentials:!0}).pipe(h(()=>{this._users.update(t=>t.filter(r=>r.id!==e))}),o(t=>(this._error.set(t.error?.error||"Kunde inte ta bort anv\xE4ndare"),n(()=>t))))}setUserLocked(e,t){return this.http.put(`${this.apiUrl}/${e}/lock?locked=${t}`,{},{withCredentials:!0}).pipe(h(r=>{this._users.update(i=>i.map(s=>s.id===e?r:s))}),o(r=>(this._error.set(r.error?.error||"Kunde inte uppdatera anv\xE4ndare"),n(()=>r))))}resetPassword(e){return this.http.post(`${this.apiUrl}/${e}/reset-password`,{},{withCredentials:!0})}clearError(){this._error.set(null)}generatePassword(e=16){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r="abcdefghijklmnopqrstuvwxyz",i="0123456789",s="!@#$%^&*()_+-=",p=t+r+i+s,a="";a+=t[Math.floor(Math.random()*t.length)],a+=r[Math.floor(Math.random()*r.length)],a+=i[Math.floor(Math.random()*i.length)],a+=s[Math.floor(Math.random()*s.length)];for(let d=4;d<e;d++)a+=p[Math.floor(Math.random()*p.length)];return a.split("").sort(()=>Math.random()-.5).join("")}calculatePasswordStrength(e){if(!e)return null;let t=0;return e.length>=8&&t++,e.length>=12&&t++,/[a-z]/.test(e)&&t++,/[A-Z]/.test(e)&&t++,/[0-9]/.test(e)&&t++,/[^a-zA-Z0-9]/.test(e)&&t++,t<=2?"svagt":t<=4?"mellan":"starkt"}static \u0275fac=function(t){return new(t||l)};static \u0275prov=c({token:l,factory:l.\u0275fac,providedIn:"root"})}return l})();export{$ as a};
