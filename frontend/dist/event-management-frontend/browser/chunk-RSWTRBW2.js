import"./chunk-ZVSLRWYB.js";import{a as N}from"./chunk-A4UUN2PI.js";import{a as se,c as le,d as ce}from"./chunk-IPLAP3G7.js";import{a as ne,b as oe,e as re,h as ae}from"./chunk-6U4QZZGF.js";import"./chunk-LXGICSYG.js";import{a as me,c as he,g as I,h as pe,i as ge}from"./chunk-BJFHX53N.js";import{a as _e,b as ye}from"./chunk-3JMVZ7SM.js";import"./chunk-ZQUZFYVM.js";import{b as W,d as D,f as q,g as K,j as G,l as Y,m as Z,o as X,p as J,q as ee,r as te,w as ie}from"./chunk-NEXUFI76.js";import{A as ue,B as fe,a as x,b as M,d as E,e as O,f as T,g as F,h as P,r as de}from"./chunk-PZ4Z3RAM.js";import{X as A,d as Q,g as S,ja as $}from"./chunk-EGCVCM76.js";import{Aa as g,Ab as c,Bb as U,Cb as j,Db as e,Eb as t,Fb as f,Jb as V,Lb as p,Mb as _,Xb as o,Y as R,Yb as C,Za as r,Zb as m,ba as u,ja as L,jb as y,ka as H,kb as k,ob as h,ub as w}from"./chunk-QXQWZ6TV.js";var Ce=(()=>{class i{static \u0275fac=function(s){return new(s||i)};static \u0275mod=k({type:i});static \u0275inj=R({imports:[de]})}return i})();var we=(()=>{class i{static \u0275fac=function(s){return new(s||i)};static \u0275mod=k({type:i});static \u0275inj=R({imports:[A,Ce,A]})}return i})();function Ie(i,l){i&1&&(e(0,"mat-error"),o(1,"E-post \xE4r obligatoriskt"),t())}function Ae(i,l){i&1&&(e(0,"mat-error"),o(1,"Ange en giltig e-postadress"),t())}function Be(i,l){if(i&1&&(e(0,"div",21)(1,"span",30),o(2,"L\xF6senordsstyrka:"),t(),e(3,"span",31),o(4),t()()),i&2){let n=_();r(3),w("ngClass",n.passwordStrength()),r(),m(" ",n.getStrengthLabel(n.passwordStrength())," ")}}function ze(i,l){i&1&&(e(0,"mat-error",22),o(1," L\xF6senord \xE4r obligatoriskt "),t())}function Le(i,l){i&1&&(e(0,"mat-error",22),o(1," L\xF6senordet m\xE5ste vara minst 8 tecken "),t())}function He(i,l){i&1&&f(0,"mat-spinner",29)}function Ue(i,l){i&1&&o(0," L\xE4gg till anv\xE4ndare ")}var De=(()=>{class i{fb=u(X);userService=u(N);dialogRef=u(me);form;showPassword=g(!1);saving=g(!1);passwordStrength=g(null);constructor(){this.form=this.fb.group({firstName:[""],lastName:[""],email:["",[D.required,D.email]],password:["",[D.required,D.minLength(8)]],sendNotification:[!1]}),this.form.get("password")?.valueChanges.subscribe(n=>{this.passwordStrength.set(this.userService.calculatePasswordStrength(n))})}toggleShowPassword(){this.showPassword.set(!this.showPassword())}generatePassword(){let n=this.userService.generatePassword(16);this.form.patchValue({password:n}),this.showPassword.set(!0)}getStrengthLabel(n){switch(n){case"svagt":return"Svagt";case"mellan":return"Mellan";case"starkt":return"Starkt";default:return""}}onSubmit(){if(this.form.invalid)return;this.saving.set(!0);let n=this.form.value;this.userService.createAdmin({firstName:n.firstName||void 0,lastName:n.lastName||void 0,email:n.email,password:n.password,sendNotification:n.sendNotification}).subscribe({next:s=>{this.saving.set(!1),this.dialogRef.close(s)},error:()=>{this.saving.set(!1)}})}onCancel(){this.dialogRef.close()}static \u0275fac=function(s){return new(s||i)};static \u0275cmp=y({type:i,selectors:[["app-create-user-dialog"]],decls:56,vars:10,consts:[[1,"dialog-container"],[1,"dialog-header"],[1,"subtitle"],["mat-icon-button","",1,"close-button",3,"click"],[3,"ngSubmit","formGroup"],[1,"form-content"],[1,"form-row"],["appearance","outline",1,"half-width"],["matInput","","formControlName","firstName","placeholder","Ange f\xF6rnamn"],["matInput","","formControlName","lastName","placeholder","Ange efternamn"],["appearance","outline",1,"full-width"],["matInput","","type","email","formControlName","email","placeholder","namn@exempel.se"],["matSuffix","",1,"required-star"],[1,"password-section"],[1,"field-label"],[1,"required-star"],[1,"password-row"],["appearance","outline",1,"password-field"],["matInput","","formControlName","password","placeholder","Ange l\xF6senord",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["mat-stroked-button","","type","button",1,"generate-button",3,"click"],[1,"strength-indicator"],[1,"password-error"],[1,"notification-section"],["formControlName","sendNotification","color","primary"],[1,"checkbox-label"],[1,"checkbox-hint"],[1,"dialog-actions"],["mat-flat-button","","type","submit",1,"submit-button",3,"disabled"],["diameter","20"],[1,"strength-label"],[1,"strength-badge",3,"ngClass"]],template:function(s,a){if(s&1&&(e(0,"div",0)(1,"div",1)(2,"h2"),o(3,"Skapa ny administrat\xF6r"),t(),e(4,"p",2),o(5,"L\xE4gg till en ny administrat\xF6r till systemet"),t(),e(6,"button",3),p("click",function(){return a.onCancel()}),e(7,"mat-icon"),o(8,"close"),t()()(),e(9,"form",4),p("ngSubmit",function(){return a.onSubmit()}),e(10,"div",5)(11,"div",6)(12,"mat-form-field",7)(13,"mat-label"),o(14,"F\xF6rnamn"),t(),f(15,"input",8),t(),e(16,"mat-form-field",7)(17,"mat-label"),o(18,"Efternamn"),t(),f(19,"input",9),t()(),e(20,"mat-form-field",10)(21,"mat-label"),o(22,"E-postadress"),t(),f(23,"input",11),e(24,"span",12),o(25,"*"),t(),h(26,Ie,2,0,"mat-error")(27,Ae,2,0,"mat-error"),t(),e(28,"div",13)(29,"label",14),o(30," L\xF6senord "),e(31,"span",15),o(32,"*"),t()(),e(33,"div",16)(34,"mat-form-field",17),f(35,"input",18),e(36,"button",19),p("click",function(){return a.toggleShowPassword()}),e(37,"mat-icon"),o(38),t()()(),e(39,"button",20),p("click",function(){return a.generatePassword()}),e(40,"mat-icon"),o(41,"refresh"),t(),o(42," Generera "),t()(),h(43,Be,5,2,"div",21)(44,ze,2,0,"mat-error",22)(45,Le,2,0,"mat-error",22),t(),e(46,"div",23)(47,"mat-checkbox",24)(48,"span",25),o(49,"Skicka avisering till anv\xE4ndaren via e-post"),t()(),e(50,"p",26),o(51," Anv\xE4ndaren kommer att f\xE5 ett v\xE4lkomstmeddelande med inloggningsuppgifter "),t()()(),e(52,"div",27)(53,"button",28),h(54,He,1,0,"mat-spinner",29)(55,Ue,1,0),t()()()()),s&2){let d,z,v,b;r(9),w("formGroup",a.form),r(17),c((d=a.form.get("email"))!=null&&d.hasError("required")?26:-1),r(),c((z=a.form.get("email"))!=null&&z.hasError("email")?27:-1),r(8),w("type",a.showPassword()?"text":"password"),r(3),C(a.showPassword()?"visibility_off":"visibility"),r(5),c(a.passwordStrength()?43:-1),r(),c((v=a.form.get("password"))!=null&&v.touched&&((v=a.form.get("password"))!=null&&v.hasError("required"))?44:-1),r(),c((b=a.form.get("password"))!=null&&b.touched&&((b=a.form.get("password"))!=null&&b.hasError("minlength"))?45:-1),r(8),w("disabled",a.form.invalid||a.saving()),r(),c(a.saving()?54:55)}},dependencies:[S,Q,ee,G,W,q,K,Y,Z,I,se,ae,ne,oe,re,ce,le,E,M,x,T,O,ye,_e,P,F],styles:[".dialog-container[_ngcontent-%COMP%]{padding:24px}.dialog-header[_ngcontent-%COMP%]{position:relative;margin-bottom:24px}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:500;color:#333}.dialog-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:4px 0 0;font-size:14px;color:#666}.dialog-header[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{position:absolute;top:-8px;right:-8px;color:#999}.form-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px}.full-width[_ngcontent-%COMP%]{width:100%}.half-width[_ngcontent-%COMP%]{flex:1}.required-star[_ngcontent-%COMP%]{color:#f44336}.field-label[_ngcontent-%COMP%]{display:block;font-size:14px;color:#333;margin-bottom:8px}.password-section[_ngcontent-%COMP%]{margin-bottom:16px}.password-row[_ngcontent-%COMP%]{display:flex;gap:12px}.password-field[_ngcontent-%COMP%]{flex:1}.generate-button[_ngcontent-%COMP%]{height:56px;white-space:nowrap}.generate-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:4px}.strength-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-top:8px;padding:12px;background:#f5f5f5;border-radius:8px}.strength-label[_ngcontent-%COMP%]{font-size:13px;color:#666}.strength-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:16px;font-size:12px;font-weight:500}.strength-badge.svagt[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.strength-badge.mellan[_ngcontent-%COMP%]{background:#fff8e1;color:#f57f17}.strength-badge.starkt[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.password-error[_ngcontent-%COMP%]{font-size:12px;margin-top:4px}.notification-section[_ngcontent-%COMP%]{background:#f5f5e8;padding:16px;border-radius:8px;border:1px solid #e8e8d8}.notification-section[_ngcontent-%COMP%]   .checkbox-label[_ngcontent-%COMP%]{font-size:14px;color:#333}.notification-section[_ngcontent-%COMP%]   .checkbox-hint[_ngcontent-%COMP%]{margin:4px 0 0 32px;font-size:13px;color:#666}.dialog-actions[_ngcontent-%COMP%]{margin-top:24px}.submit-button[_ngcontent-%COMP%]{width:100%;height:48px;background:#8bc34a!important;color:#fff!important;font-size:15px;font-weight:500;border-radius:8px}.submit-button[_ngcontent-%COMP%]:disabled{background:#ccc!important}[_nghost-%COMP%]     .mat-mdc-form-field-flex{height:56px!important}[_nghost-%COMP%]     .mdc-text-field--outlined{--mdc-outlined-text-field-container-shape: 8px}"]})}return i})();var je=(i,l)=>l.id;function Ve(i,l){i&1&&(e(0,"div",8),f(1,"mat-spinner",10),t())}function Qe(i,l){if(i&1){let n=V();e(0,"tr")(1,"td")(2,"div",13)(3,"div",14),o(4),t(),e(5,"span",15),o(6),t()()(),e(7,"td"),o(8),t(),e(9,"td",16),o(10),t(),e(11,"td",17)(12,"button",18),p("click",function(){let a=L(n).$implicit,d=_(2);return H(d.deleteUser(a))}),e(13,"mat-icon"),o(14,"delete_outline"),t()()()()}if(i&2){let n=l.$implicit;r(4),m(" ",n.initials," "),r(2),C(n.email),r(2),C(n.fullName),r(2),C(n.email)}}function $e(i,l){if(i&1&&(e(0,"mat-card",9)(1,"table",11)(2,"thead")(3,"tr")(4,"th"),o(5,"Anv\xE4ndarnamn"),t(),e(6,"th"),o(7,"Namn"),t(),e(8,"th"),o(9,"E-postadress"),t(),f(10,"th"),t()(),e(11,"tbody"),U(12,Qe,15,4,"tr",null,je),t()(),e(14,"div",12),o(15),t()()),i&2){let n=_();r(12),j(n.users()),r(3),m(" ",n.users().length," objekt ")}}var ui=(()=>{class i{userService=u(N);authService=u($);dialog=u(he);snackBar=u(ue);users=this.userService.users;loading=this.userService.loading;totalCount=g(0);adminCount=g(0);ngOnInit(){this.loadUsers(),this.loadCounts()}loadUsers(){this.userService.getAdmins().subscribe({error:n=>{this.snackBar.open("Kunde inte h\xE4mta anv\xE4ndare","St\xE4ng",{duration:5e3,panelClass:"error-snackbar"})}})}loadCounts(){this.userService.getCounts().subscribe({next:n=>{this.totalCount.set(n.total),this.adminCount.set(n.admins)}})}openCreateDialog(){this.dialog.open(De,{width:"500px",disableClose:!0}).afterClosed().subscribe(s=>{s&&(this.loadCounts(),this.snackBar.open(`Administrat\xF6r ${s.firstName||""} ${s.lastName||""} har lagts till`,"St\xE4ng",{duration:4e3,panelClass:"success-snackbar"}))})}deleteUser(n){confirm(`\xC4r du s\xE4ker p\xE5 att du vill ta bort ${n.fullName}?`)&&this.userService.deleteUser(n.id).subscribe({next:()=>{this.loadCounts(),this.snackBar.open(`Administrat\xF6r ${n.fullName} har tagits bort`,"St\xE4ng",{duration:4e3,panelClass:"success-snackbar"})},error:s=>{this.snackBar.open(s.error?.error||"Kunde inte ta bort anv\xE4ndare","St\xE4ng",{duration:5e3,panelClass:"error-snackbar"})}})}static \u0275fac=function(s){return new(s||i)};static \u0275cmp=y({type:i,selectors:[["app-user-management"]],decls:19,vars:4,consts:[[1,"user-management-container"],[1,"page-header"],[1,"header-left"],[1,"header-icon"],[1,"header-text"],[1,"subtitle"],[1,"admin-link"],["mat-flat-button","",1,"add-button",3,"click"],[1,"loading-container"],[1,"users-card"],["diameter","48"],[1,"users-table"],[1,"table-footer"],[1,"user-cell"],[1,"user-avatar"],[1,"username"],[1,"email-cell"],[1,"actions-cell"],["mat-icon-button","","matTooltip","Ta bort anv\xE4ndare",1,"delete-button",3,"click"]],template:function(s,a){s&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"mat-icon"),o(5,"shield"),t()(),e(6,"div",4)(7,"h1"),o(8,"Anv\xE4ndare"),t(),e(9,"p",5),o(10),e(11,"span",6),o(12),t()()()(),e(13,"button",7),p("click",function(){return a.openCreateDialog()}),e(14,"mat-icon"),o(15,"add"),t(),o(16," L\xE4gg till "),t()(),h(17,Ve,2,0,"div",8)(18,$e,16,1,"mat-card",9),t()),s&2&&(r(10),m(" Alla (",a.totalCount(),") | "),r(2),m("Administrat\xF6r (",a.adminCount(),")"),r(5),c(a.loading()?17:-1),r(),c(a.loading()?-1:18))},dependencies:[S,J,ie,te,E,M,x,T,O,we,I,fe,P,F,ge,pe],styles:[".user-management-container[_ngcontent-%COMP%]{min-height:100vh;background:#fafafa;padding:24px}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:24px}.header-left[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:16px}.header-icon[_ngcontent-%COMP%]{width:56px;height:56px;background:#8bc34a;border-radius:12px;display:flex;align-items:center;justify-content:center}.header-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff;font-size:28px;width:28px;height:28px}.header-text[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:500;color:#333}.header-text[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:4px 0 0;font-size:14px;color:#666}.header-text[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]   .admin-link[_ngcontent-%COMP%]{color:#8bc34a;cursor:pointer}.add-button[_ngcontent-%COMP%]{background:#8bc34a!important;color:#fff!important;font-weight:500;padding:0 24px;height:40px}.add-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:4px}.loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:64px}.users-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #00000014;overflow:hidden}.users-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.users-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:#f5f5f5}.users-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:16px 24px;text-align:left;font-weight:500;color:#666;font-size:14px;border-bottom:1px solid #e0e0e0}.users-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #f0f0f0;transition:background .2s}.users-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#fafafa}.users-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child{border-bottom:none}.users-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:16px 24px;font-size:14px;color:#333}.user-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.user-avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:#e8e8e8;display:flex;align-items:center;justify-content:center;font-size:14px;color:#666;font-weight:500}.username[_ngcontent-%COMP%], .email-cell[_ngcontent-%COMP%]{color:#8bc34a}.actions-cell[_ngcontent-%COMP%]{text-align:right}.delete-button[_ngcontent-%COMP%]{color:#999}.delete-button[_ngcontent-%COMP%]:hover{color:#f44336}.table-footer[_ngcontent-%COMP%]{padding:12px 24px;text-align:right;font-size:13px;color:#999;border-top:1px solid #f0f0f0;background:#fafafa}"]})}return i})();export{ui as UserManagementComponent};
